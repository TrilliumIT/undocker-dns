language: go
go:
- 1.11

env:
  global:
  - GO15VENDOREXPERIMENT=1
  - GOOS=linux

before_install:
- curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
- dep ensure

install:
- go get -t ./...

script:
  - mv $GOPATH/bin/undocker-dns ./
  - md5sum undocker-dns > md5.txt
  - md5sum undocker-dns.service >> md5.txt
  - sha256sum undocker-dns > sha256.txt
  - sha256sum undocker-dns.service >> sha256.txt
  - sha512sum undocker-dns > sha512.txt
  - sha512sum undocker-dns.service >> sha512.txt

deploy:
  - provider: releases
    skip_cleanup: true
    api_key:
      secure: lHaIpkfFvny3RCvZtpvtJBbPZw09gI7AFQ2YqBsbxX70ODXz8I5iYRGDfEAtuqITpkmf0xRs82wEi+f9IaYD4KcxQe2UQW6TvCCrrDLpuja1SnAmSN268x+t15gdWCgBaa54XGfQmnJ4FLVUZ8Nq5p7A3A7YufSpyCxQmwJe3NGi3jKoBtPxnzwfDqUJx6ix3+gGAO0kNdbNQd9KJD3wmtP64A8Dd/L0EcBpcQSHtGlKlkKAh9hUQPfE445gIxSUoG5+HG5Ca0TClKb7V7rGa8Um5iT6eLZH3rfJYbkH9VMlI2jZU+OmnPdBYeXoAzGQChjAp5Y423vJ4EOElfovpwC7XLhHQcQv/ZxU08X+2QoZ1mqataIQqOUZCC/rCD/EUuJs8uCUPL84FJpAmybgJtRlT0vgDaE3mTRzrwQDfch9Leu4T8qtRhP9QB4QLhuvFTjPlSB7eHpb7uagg1S5Lj7yT7W5W91x0zulA3ooYn8Au77L+437M2LXxEiZ4n3c3wWfbIIQ5btA/AE9tE0tsXQcsBMdnyrO3cFvgv3+fHb31gqEf8pYnJb8YbBFjGoHir1TV3R7y8ph30/4y1LZRBJexnRwVLJZM9PT4IKSLhG03OCmZY8YCeIq8c/i9Kb8/TaAgYqj3rhJwEKkdrnIpVZZ652colt9AiESrGmLMAw=
    file:
      - undocker-dns
      - undocker-dns.service
      - md5.txt
      - sha256.txt
      - sha512.txt
    on:
      tags: true
